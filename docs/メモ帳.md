# メモ帳


## テーブルを作る
```
drop table contents;
create table contents (item varchar(20), genre varchar(20)[], subgenre varchar(20)[], start timestamp, stop timestamp, primary key (item));
\copy contents from 'data.txt'with null as '';
(場合によっては)
CREATE INDEX genre_index ON public.contents USING gin (genre);
```

## SQLをいくつか試して

ジャンルを指定してもコンテンツID指定があると早くならない問題があった
ジャンルを別テーブルにしてJOINすることで改善がある

作り方
```sql
create table genres AS select unnest(genre) as genre , item from contents;
create index genre_genre_index on genres  (genre);
```

## ほぼ０件返却問題
ランダムに選んだアイテム、ランダムに選んだジャンルのセットでは
０件返却が多すぎる
アイテムに割つくジャンル名が推測可能なルールが必要

### このようにしたい
* アイテムのID　上位４桁、５桁　をPrefixに使い
``` 
12345678 なら 45
```
* カイ二乗で要素数を決定し、要素番号をSuffixに使い
```
1要素目を450,2要素目を451とする
```
* Prefix,Suffixを合成してジャンル名とする

### 上の案はめんどくさいので中止　ジャンルは数字２文字にする
